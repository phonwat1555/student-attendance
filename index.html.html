<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡∏õ‡∏ß‡∏ä.‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* TH Sarabun New Font Import */
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f8fafc;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 1.5rem;
        }
        .header-soft-gradient {
            background: linear-gradient(135deg, #a7b7ec 0%, #a48ad9 100%);
        }
        .btn-primary {
            background-color: #6366f1;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover {
            background-color: #4f46e5;
            transform: translateY(-1px);
        }
        /* NEW Minimal Button Styles */
        .btn-status {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding-top: 1rem;
            padding-bottom: 1rem;
            border-radius: 1rem;
            border-width: 2px;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s ease-in-out;
            background-color: white;
        }
        .btn-status:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
            color: white;
        }
        .btn-status svg {
            width: 2.25rem;
            height: 2.25rem;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease-in-out;
        }
        .btn-status:hover svg {
            transform: scale(1.1);
            color: white;
        }
        .status-present {
            border-color: #2ecc71;
            color: #2ecc71;
        }
        .status-present:hover {
            background-color: #2ecc71;
        }
        .status-late {
            border-color: #f1c40f;
            color: #f1c40f;
        }
        .status-late:hover {
            background-color: #f1c40f;
        }
        .status-absent {
            border-color: #e74c3c;
            color: #e74c3c;
        }
        .status-absent:hover {
            background-color: #e74c3c;
        }
        .status-leave {
            border-color: #3498db;
            color: #3498db;
        }
        .status-leave:hover {
            background-color: #3498db;
        }
        .card {
            background-color: white;
            border-radius: 1.25rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
        }
        .chart-container {
            position: relative;
            height: 40vh;
            width: 100%;
        }
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
        }
        .input-field {
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            width: 100%;
            font-size: 1rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        table {
            border-collapse: separate;
            border-spacing: 0;
        }
        th, td {
            border-bottom: 1px solid #f1f5f9;
        }
        th:first-child { border-top-left-radius: 0.75rem; }
        th:last-child { border-top-right-radius: 0.75rem; }
        tr:last-child td:first-child { border-bottom-left-radius: 0.75rem; }
        tr:last-child td:last-child { border-bottom-right-radius: 0.75rem; }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div id="mainContent" class="container flex-grow">
        <header class="header-soft-gradient text-white p-6 rounded-xl shadow-md mb-8">
            <h1 class="text-3xl font-bold text-center mb-2">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô üìö
            </h1>
            <p class="text-lg text-center opacity-90">
                ‡∏õ‡∏ß‡∏ä.‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤
            </p>
        </header>

        <main>
            <div id="loginPage" class="card p-8 max-w-md mx-auto mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üîë
                </h2>

                <div id="studentLoginSection" class="mb-8 p-4 border rounded-lg bg-indigo-50">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 text-center">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô üßë‚Äçüéì</h3>
                    <div class="mb-4">
                        <label for="studentIdLoginInput" class="block text-gray-700 text-sm font-bold mb-2">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</label>
                        <input type="text" id="studentIdLoginInput" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" class="input-field">
                    </div>
                    <button id="studentLoginButton" class="btn-primary w-full">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤)</button>
                </div>

                <!-- Link to show the teacher login form -->
                <div id="teacherLoginToggle" class="text-center mt-6">
                    <a href="#" id="showTeacherLoginLink" class="text-sm text-gray-600 hover:text-gray-900">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π/‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</a>
                </div>
                
                <!-- Teacher Login Section is now hidden by default -->
                <div id="teacherLoginSection" class="mt-8 p-4 border rounded-lg bg-gray-50 hidden">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 text-center">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π üë®‚Äçüè´</h3>
                    <div class="mb-4">
                        <label for="teacherUsernameInput" class="block text-gray-700 text-sm font-bold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                        <input type="text" id="teacherUsernameInput" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏π" class="input-field">
                    </div>
                    <div id="teacherPasswordContainer" class="mb-6">
                        <label for="teacherPasswordInput" class="block text-gray-700 text-sm font-bold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                        <input type="password" id="teacherPasswordInput" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏π" class="input-field">
                    </div>
                    <button id="teacherLoginButton" class="btn-primary w-full">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)</button>
                </div>
            </div>

            <div id="homePage" class="card p-6 mb-8 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π üìä</h2>
                    <div class="flex gap-2">
                        <button id="refreshDataButtonHome" class="btn-primary flex items-center px-4 py-2 text-sm">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                        <button id="logoutButtonTeacher" class="btn-primary flex items-center px-4 py-2 text-sm">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </div>
                <div class="mb-6 flex flex-col sm:flex-row items-center gap-4">
                    <label for="summaryDateInput" class="text-lg font-semibold text-gray-700 whitespace-nowrap">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡∏∏‡∏õ:</label>
                    <input type="date" id="summaryDateInput" class="input-field max-w-xs sm:w-auto flex-grow">
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-6" id="attendanceSummary"></div>

                <div class="mt-8 text-center">
                     <button id="toggleManagementButton" class="btn-primary">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</button>
                </div>
                
                <div id="studentManagementSection" class="mt-6 hidden">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 mt-8">‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• üßë‚Äçüíª</h3>
                    <div class="flex flex-col sm:flex-row gap-4 mb-4">
                        <input type="text" id="quickStudentIdSearchInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="input-field flex-grow">
                        <button id="quickStudentSearchButton" class="btn-primary w-full sm:w-auto">‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                    </div>
                    <div id="quickStudentResultDisplay" class="card p-4 mb-6 hidden"></div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î üîç</h3>
                    <div class="flex flex-col sm:flex-row gap-4 mb-6">
                        <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" class="input-field flex-grow">
                        <button id="searchButton" class="btn-primary w-full sm:w-auto">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                    </div>
                    <div id="studentListContainer" class="max-h-96 overflow-y-auto rounded-lg border border-gray-200">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏£‡∏´‡∏±‡∏™</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody" class="bg-white divide-y divide-gray-200"></tbody>
                        </table>
                    </div>
                </div>
                <div class="mt-8 border-t pt-6 flex justify-center gap-4 flex-wrap">
                    <button id="openLiveMonitorButton" class="btn-primary bg-red-600 hover:bg-red-700">‡πÄ‡∏õ‡∏¥‡∏î Live Monitor</button>
                    <button id="viewDailyRecordsButton" class="btn-primary">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button id="exportDailySummaryButton" class="btn-primary">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ</button>
                    <button id="saveDailySummaryToHistoryButton" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ</button>
                </div>
            </div>
            
            <div id="studentDetailPage" class="card p-6 hidden">
                <!-- Content for student detail page, will be populated by JS -->
            </div>

            <div id="dailyRecordsPage" class="card p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <button id="backToHomeFromDailyRecordsButton" class="btn-primary flex items-center">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
                    <div class="flex gap-2">
                        <button id="refreshDataButtonDailyRecords" class="btn-primary flex items-center px-4 py-2 text-sm">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô üóìÔ∏è</h2>
                <div class="mb-4 flex flex-col sm:flex-row items-center gap-4">
                    <label for="dailyRecordDateInput" class="block text-gray-700 text-sm font-bold whitespace-nowrap">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <input type="date" id="dailyRecordDateInput" class="input-field max-w-xs mx-auto mb-4 sm:mb-0">
                    <button id="exportSpecificDailyRecordsButton" class="btn-primary w-full sm:w-auto">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                </div>
                <div id="dailyRecordsContainer" class="max-h-96 overflow-y-auto rounded-lg border border-gray-200">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50 sticky top-0">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="dailyRecordsTableBody" class="bg-white divide-y divide-gray-200"></tbody>
                    </table>
                </div>
            </div>
        </main>
        <footer class="text-center py-6 text-gray-600 text-sm mt-8">
            <p>‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå &copy; 2025 ‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤ : ‡∏ô‡∏≤‡∏¢‡∏õ‡∏±‡∏ì‡∏ì‡∏ò‡∏£ ‡∏ö‡∏∏‡∏ç‡πÄ‡∏°‡∏ò‡∏≤‡∏†‡∏±‡∏ó‡∏£</p>
        </footer>
    </div>
    
    <!-- Full Screen Live Monitor Page -->
    <div id="liveMonitorPage" class="fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm p-4 sm:p-6 lg:p-8 hidden z-50">
        <div class="bg-white rounded-2xl shadow-2xl h-full flex flex-col">
            <header class="p-4 border-b flex justify-between items-center">
                 <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-3">
                    <span class="relative flex h-3 w-3">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-3 w-3 bg-red-600"></span>
                    </span>
                    Live Monitor
                </h2>
                 <button id="backToHomeFromMonitorButton" class="btn-primary bg-gray-600 hover:bg-gray-700">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
            </header>
            <div id="fullScreenMonitorBody" class="flex-grow p-2 overflow-y-auto">
                 <!-- Content injected by JS -->
            </div>
        </div>
    </div>
    
    <script>
        // Students Data
        const students = [
            { id: "67130492101", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏≠‡∏ä‡∏¥‡∏ï‡∏û‡∏•", lastName: "‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏£‡∏≤‡∏°" },
            { id: "67130492102", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ä‡∏ç‡∏≤‡∏î‡∏≤", lastName: "‡∏´‡πâ‡∏≠‡∏¢‡∏û‡∏£‡∏°‡∏£‡∏≤‡∏ä" },
            { id: "67130492103", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏≠‡∏£‡∏¥‡∏™", lastName: "‡∏ó‡∏≠‡∏á‡∏î‡∏µ" },
            { id: "67130492105", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏õ‡∏£‡∏µ‡∏¢‡∏≤‡∏û‡∏£", lastName: "‡∏ô‡∏¥‡∏™‡∏¢‡∏±‡∏ô‡∏ï‡πå" },
            { id: "67130492106", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå", lastName: "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏™‡∏ß‡∏¢‡∏à‡∏¥‡∏Å" },
            { id: "67130492107", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏Å‡∏ô‡∏¥‡∏©‡∏ê‡∏≤", lastName: "‡∏õ‡∏ß‡∏á‡∏™‡∏∏‡∏Ç" },
            { id: "67130492108", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏î‡∏ß‡∏á‡∏™‡∏∏‡∏î‡∏≤", lastName: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ô‡∏≤" },
            { id: "67130492109", gender: "‡∏ô‡∏≤‡∏á", firstName: "‡∏ê‡∏¥‡∏ï‡∏¥‡∏û‡∏£", lastName: "‡∏™‡∏∏‡∏Ñ‡∏ô‡∏ò‡πå" },
            { id: "67130492111", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ì‡∏±‡∏ê‡∏ï‡∏¥‡∏¢‡∏≤", lastName: "‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå" },
            { id: "67130492112", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ô‡∏±‡∏ô‡∏ò‡∏¥‡∏ô‡∏µ‡∏¢‡πå", lastName: "‡∏ï‡∏∞‡∏ô‡∏ô‡∏ó‡πå" },
            { id: "67130492113", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ò‡∏≤‡∏£‡∏≤", lastName: "‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ä‡∏±‡∏¢‡∏§‡∏Å‡∏©‡πå" },
            { id: "67130492114", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ì‡∏±‡∏ê‡∏ß‡∏£‡∏£‡∏ì", lastName: "‡πÑ‡∏ó‡∏¢‡∏°‡∏∞‡∏ì‡∏µ" },
            { id: "67130492115", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ô‡∏ô‡∏ó‡πå", lastName: "‡∏®‡∏£‡∏µ‡∏™‡∏±‡∏á‡∏Ç‡πå" },
            { id: "67130492116", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏®‡∏®‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492117", gender: "‡∏ô‡∏≤‡∏á", firstName: "‡∏≠‡∏°‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏î‡∏≥‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏®‡∏≤‡∏•" },
            { id: "67130492118", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏£‡∏¥‡∏®‡∏£‡∏≤", lastName: "‡∏Ç‡∏±‡∏ô‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°" },
            { id: "67130492119", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏¥‡πä‡∏Å", lastName: "‡∏°‡∏¥‡∏°‡∏≤‡∏ã‡∏≤" },
            { id: "67130492120", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ô‡∏∏‡∏ä‡∏à‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", lastName: "‡∏Å‡∏£‡∏¥‡∏î‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492121", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏£‡∏±‡∏™‡∏™‡∏¥‡∏ï‡∏≤", lastName: "‡πÄ‡∏ä‡∏≤‡∏ß‡πå‡∏Ç‡∏∏‡∏ô‡∏ó‡∏î" },
            { id: "67130492122", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏£", lastName: "‡πÇ‡∏Ç‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞" },
            { id: "67130492123", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏†‡∏≤", lastName: "‡∏•‡∏≤‡∏ß‡∏á‡∏©‡∏≤" },
            { id: "67130492124", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏°‡∏¥‡πà‡∏á‡∏Ç‡∏ß‡∏±‡∏ç", lastName: "‡∏£‡∏±‡∏Å‡∏©‡∏≤" },
            { id: "67130492125", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏à‡∏¥‡∏£‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå", lastName: "‡∏à‡∏≠‡∏°‡∏≠‡∏∏‡∏¢" },
            { id: "67130492126", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏°‡∏≤‡∏ô‡∏±‡∏ê‡∏ä‡∏±‡∏¢", lastName: "‡∏ô‡∏±‡∏¢‡∏ö‡∏∏‡∏£‡∏∏‡∏©" },
            { id: "67130492128", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤", lastName: "‡∏Å‡∏≤‡∏¨‡∏à‡∏±‡∏ô‡πÇ‡∏ó" },
            { id: "67130492129", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ò‡∏ß‡∏±‡∏ä‡∏ä‡∏±‡∏¢", lastName: "‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏ß‡∏±‡∏•‡∏¢‡πå" },
            { id: "67130492130", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏≤‡∏¢‡∏ù‡∏ô", lastName: "‡πÄ‡∏Ç‡∏ô‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞" },
            { id: "67130492131", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ó‡∏¥‡∏û‡∏¢‡πå‡πÄ‡∏Å‡∏™‡∏£", lastName: "‡∏ó‡∏¥‡∏û‡∏¢‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê" },
            { id: "67130492132", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ß‡∏¥‡∏à‡∏±‡∏¢", lastName: "‡∏´‡∏á‡∏©‡πå‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì" },
            { id: "67130492133", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ß‡∏£‡∏£‡∏ò‡∏ô‡∏±‡∏¢", lastName: "‡∏û‡∏∏‡∏ó‡∏ò‡∏¥‡∏°‡∏≤" },
            { id: "67130492134", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏≠‡∏°‡∏£‡πÄ‡∏ó‡∏û", lastName: "‡∏î‡∏µ‡∏™‡∏π‡∏á‡πÄ‡∏ô‡∏¥‡∏ô" },
            { id: "67130492135", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏Å‡∏±‡∏•‡∏¢‡∏Å‡∏£", lastName: "‡∏Å‡πâ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492136", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏à‡∏≤‡∏£‡∏ß‡∏µ", lastName: "‡πÄ‡∏ô‡∏≤‡∏ß‡πå‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞" },
            { id: "67130492137", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ß‡∏¥‡πÇ‡∏£‡∏à‡∏ô‡πå", lastName: "‡πÄ‡∏ï‡∏ä‡∏∞‡∏ß‡∏±‡∏ä‡∏£‡∏≤‡∏ô‡∏∏‡∏Å‡∏π‡∏•" },
            { id: "67130492138", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏õ‡∏¥‡∏¢‡∏Ç‡∏ß‡∏±‡∏ç", lastName: "‡∏û‡∏á‡∏®‡πå‡∏ß‡∏¥‡∏™‡∏¥‡∏©‡∏ê‡πå" },
            { id: "67130492140", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏£‡∏£‡∏ì‡∏ô‡∏†‡∏≤", lastName: "‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå" },
            { id: "67130492201", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ì‡∏±‡∏ê‡∏Å‡∏°‡∏•", lastName: "‡∏™‡∏≤‡∏û‡∏¥‡∏°‡∏•" },
            { id: "67130492202", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏†‡∏π‡∏ï‡∏∞‡∏ß‡∏±‡∏ô", lastName: "‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå" },
            { id: "67130492203", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏•‡∏±‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå", lastName: "‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏ô‡∏≤" },
            { id: "67130492204", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏õ‡∏£‡∏∞‡∏†‡∏≤‡∏û‡∏£", lastName: "‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÇ‡∏Ñ‡∏Å‡∏™‡∏π‡∏á" },
            { id: "67130492205", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏≠‡∏£‡∏ß‡∏£‡∏£‡∏ì", lastName: "‡∏ä‡∏≠‡∏ö‡∏î‡πà‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492206", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏≠‡∏£‡∏±‡∏ç‡∏ç‡∏≤", lastName: "‡∏â‡∏¥‡∏°‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492207", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏≠‡πà‡∏≠‡∏ô‡∏ö‡∏∏‡∏ï‡∏£" },
            { id: "67130492208", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏õ‡∏±‡∏ì‡∏ì‡∏ò‡∏£", lastName: "‡∏ö‡∏∏‡∏ç‡πÄ‡∏°‡∏ò‡∏≤‡∏†‡∏±‡∏ó‡∏£" },
            { id: "67130492209", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ä‡∏¥‡∏ô‡∏ß‡∏±‡∏ï‡∏£", lastName: "‡∏õ‡∏•‡∏±‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492210", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏Å‡∏±‡∏ç‡∏ç‡∏≤", lastName: "‡∏´‡∏ô‡∏π‡πÅ‡∏™‡∏á" },
            { id: "67130492211", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏£‡∏∏‡πà‡∏á‡∏ß‡∏¥‡∏†‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏ó‡∏≠‡∏á‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ò‡∏µ‡∏ò‡∏±‡∏ä" },
            { id: "67130492212", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏à‡∏≤‡∏£‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå", lastName: "‡πÑ‡∏´‡∏ô‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492213", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ó‡∏¥‡∏ä‡∏≤‡∏ô‡∏ô‡∏ó‡πå", lastName: "‡∏â‡∏±‡∏ô‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°" },
            { id: "67130492214", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏≠‡∏£‡∏≠‡∏ô‡∏á‡∏Ñ‡πå", lastName: "‡∏à‡∏±‡∏ô‡∏ó‡∏¥‡∏°‡∏≤" },
            { id: "67130492215", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏Ç‡∏ß‡∏±‡∏ì‡∏å‡∏û‡∏±‡∏™‡∏î‡∏£‡πå", lastName: "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏£‡∏≠‡∏î" },
            { id: "67130492216", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡πÄ‡∏Å‡∏®‡∏£‡∏¥‡∏ô", lastName: "‡πÑ‡∏û‡∏£‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492217", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏®‡∏¥‡∏ß‡∏û‡∏á‡∏©‡πå", lastName: "‡πÄ‡∏™‡∏û‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå" },
            { id: "67130492218", gender: "‡∏ô‡∏≤‡∏á", firstName: "‡∏ß‡∏£‡∏£‡∏ì‡∏©‡∏≤", lastName: "‡∏ò‡∏á‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞" },
            { id: "67130492225", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ô‡∏†‡∏±‡∏™", lastName: "‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏û‡∏à‡∏ô‡πå" },
            { id: "67130492226", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏£‡∏£‡∏ß‡∏¥‡∏©‡∏≤", lastName: "‡∏Ñ‡∏≤‡∏£‡∏≤‡∏ß‡∏∞" },
            { id: "67130492227", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå", lastName: "‡πÄ‡∏õ‡∏•‡∏∑‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492228", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏î‡∏ß‡∏á‡πÉ‡∏à", lastName: "‡πÇ‡∏à‡∏©‡∏Å‡∏•‡∏≤‡∏á" },
            { id: "67130492229", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ô‡∏±‡∏ô‡∏ó‡∏ß‡∏∏‡∏í‡∏¥", lastName: "‡∏Ñ‡∏∏‡πâ‡∏°‡∏à‡∏±‡∏ô‡∏≠‡∏±‡∏î" },
            { id: "67130492230", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏ô‡∏¥‡∏™‡∏≤", lastName: "‡∏ö‡∏∏‡∏ö‡∏ú‡∏≤‡∏ä‡∏≤‡∏ï‡∏¥" },
            { id: "67130492231", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ò‡∏±‡∏ç‡∏û‡∏±‡∏í‡∏ô‡πå", lastName: "‡πÇ‡∏ä‡∏ï‡∏¥‡∏ô‡∏¥‡∏†‡∏≤‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç" },
            { id: "67130492232", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ò‡∏±‡∏ç‡∏ç‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏Å‡∏•‡∏°‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492233", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏ô‡∏¥‡∏™‡∏≤", lastName: "‡∏õ‡∏£‡∏≠‡∏¢‡πÇ‡∏Ñ‡∏Å‡∏™‡∏π‡∏á" },
            { id: "67130492234", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏®‡∏¥‡∏ß‡∏Å‡∏£", lastName: "‡∏™‡∏≠‡∏ô‡∏´‡∏°‡∏ß‡∏Å" },
            { id: "67130492235", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏≠‡∏†‡∏¥‡∏ä‡∏±‡∏¢", lastName: "‡∏à‡∏∏‡∏°‡∏û‡∏¥‡∏é‡∏Å‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå" },
            { id: "67130492236", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ä‡∏∏‡∏ï‡∏¥‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå", lastName: "‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏ó‡∏≤" },
            { id: "67130492237", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏£‡∏ï‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå", lastName: "‡∏°‡∏µ‡∏û‡∏ß‡∏á‡∏ú‡∏•" },
            { id: "67130492238", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏£‡∏£‡∏ì", lastName: "‡πÅ‡∏î‡∏ô‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥" },
            { id: "67130492239", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤", lastName: "‡∏à‡∏≠‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ô‡∏¥‡∏ô" },
            { id: "67130492240", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏û‡∏á‡∏©‡πå", lastName: "‡∏î‡πâ‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô" },
            { id: "67130492301", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏®‡∏¥‡∏£‡∏¥‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå", lastName: "‡∏ö‡∏∏‡∏£‡∏≤‡∏ç‡∏£‡∏°‡∏ì‡πå" },
            { id: "67130492302", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏†‡∏±‡∏ì‡∏ë‡∏¥‡∏£‡∏≤", lastName: "‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå" },
            { id: "67130492303", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏£‡∏∏‡πà‡∏á‡∏ó‡∏¥‡∏ß‡∏≤", lastName: "‡∏ä‡∏∑‡πà‡∏ô‡πÅ‡∏ä‡πà‡∏°" },
            { id: "67130492304", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ß‡∏≤‡∏£‡∏∏‡∏ì‡∏µ", lastName: "‡∏û‡∏á‡∏©‡πå‡∏û‡∏±‡∏ô‡∏ô‡∏≤" },
            { id: "67130492305", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏™‡∏∏‡∏ä‡∏±‡∏ç‡∏ç‡∏≤", lastName: "‡∏ß‡∏£‡∏£‡∏ò‡∏¢‡∏≤‡∏ß‡∏£‡∏Å‡∏¥‡∏ï" },
            { id: "67130492307", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏ß‡∏£‡∏¥‡∏ô‡∏ó‡∏£", lastName: "‡∏õ‡∏µ‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™" },
            { id: "67130492308", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏°‡∏•‡∏§‡∏ó‡∏±‡∏¢", lastName: "‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ" },
            { id: "67130492309", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏õ‡∏£‡∏≤‡∏ì‡∏µ", lastName: "‡∏û‡∏á‡∏©‡πå‡∏™‡∏£‡∏∞‡∏û‡∏±‡∏á" },
            { id: "67130492310", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå", lastName: "‡πÑ‡∏õ‡∏•‡πà‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492312", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏®‡∏®‡∏¥‡∏ß‡∏£‡∏£‡∏ì", lastName: "‡∏ö‡∏∏‡∏ç‡∏®‡∏£‡∏µ" },
            { id: "67130492313", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏ö‡∏∏‡∏ç‡∏õ‡∏£‡∏∞‡∏™‡∏û", lastName: "‡∏´‡∏°‡∏≠‡∏Å‡∏Ç‡∏∏‡∏ô‡∏ó‡∏î" },
            { id: "67130492314", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏≠‡∏ô‡∏∏‡∏ä‡∏≤", lastName: "‡∏ô‡∏±‡∏î‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å" },
            { id: "67130492315", gender: "‡∏ô‡∏≤‡∏¢", firstName: "‡∏†‡∏≤‡∏ì‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå", lastName: "‡∏®‡∏£‡∏µ‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥‡πÉ‡∏™" },
            { id: "67130492316", gender: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", firstName: "‡∏õ‡∏∏‡∏ç‡∏ç‡∏¥‡∏®‡∏≤", lastName: "‡∏ä‡∏≤‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå" }
        ];

        let currentStudent = null, attendanceData = [], attendanceChartInstance, currentUserRole = null, currentUserId = null, dailyRecordsIntervalId, liveMonitorIntervalId;

        const dom = {
            loginPage: document.getElementById('loginPage'),
            homePage: document.getElementById('homePage'),
            studentDetailPage: document.getElementById('studentDetailPage'),
            dailyRecordsPage: document.getElementById('dailyRecordsPage'),
            liveMonitorPage: document.getElementById('liveMonitorPage'),
            mainContent: document.getElementById('mainContent'),
            
            studentIdLoginInput: document.getElementById('studentIdLoginInput'),
            studentLoginButton: document.getElementById('studentLoginButton'),
            teacherUsernameInput: document.getElementById('teacherUsernameInput'),
            teacherPasswordInput: document.getElementById('teacherPasswordInput'),
            teacherLoginButton: document.getElementById('teacherLoginButton'),

            summaryDateInput: document.getElementById('summaryDateInput'),
            attendanceSummary: document.getElementById('attendanceSummary'),
            
            toggleManagementButton: document.getElementById('toggleManagementButton'),
            studentManagementSection: document.getElementById('studentManagementSection'),
            quickStudentIdSearchInput: document.getElementById('quickStudentIdSearchInput'),
            quickStudentSearchButton: document.getElementById('quickStudentSearchButton'),
            quickStudentResultDisplay: document.getElementById('quickStudentResultDisplay'),
            searchInput: document.getElementById('searchInput'),
            searchButton: document.getElementById('searchButton'),
            studentsTableBody: document.getElementById('studentsTableBody'),

            openLiveMonitorButton: document.getElementById('openLiveMonitorButton'),
            backToHomeFromMonitorButton: document.getElementById('backToHomeFromMonitorButton'),
            fullScreenMonitorBody: document.getElementById('fullScreenMonitorBody'),

            viewDailyRecordsButton: document.getElementById('viewDailyRecordsButton'),
            exportDailySummaryButton: document.getElementById('exportDailySummaryButton'),
            saveDailySummaryToHistoryButton: document.getElementById('saveDailySummaryToHistoryButton'),

            logoutButtonTeacher: document.getElementById('logoutButtonTeacher'),
            refreshDataButtonHome: document.getElementById('refreshDataButtonHome'),
            
            backToHomeFromDailyRecordsButton: document.getElementById('backToHomeFromDailyRecordsButton'),
            refreshDataButtonDailyRecords: document.getElementById('refreshDataButtonDailyRecords'),
            dailyRecordDateInput: document.getElementById('dailyRecordDateInput'),
            exportSpecificDailyRecordsButton: document.getElementById('exportSpecificDailyRecordsButton'),
            dailyRecordsTableBody: document.getElementById('dailyRecordsTableBody'),
        };

        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwFPdlzuzBjGRZFKDNtAYV1mK87l2hviKp_Pp_99mtfrcrecR8MJovCrIsZtEDaWeIX/exec';

        const formatDate = (date) => {
            const d = new Date(date);
            return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
        };
        const formatDisplayDate = (date) => {
            const d = new Date(date);
            return `${String(d.getDate()).padStart(2, '0')}/${String(d.getMonth() + 1).padStart(2, '0')}/${d.getFullYear()}`;
        };

        const getStatusDetails = (status) => {
            switch (status) {
                case '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': return { icon: '‚úÖ', badgeClass: 'bg-green-100 text-green-800' };
                case '‡∏°‡∏≤‡∏™‡∏≤‡∏¢': return { icon: '‚ö†Ô∏è', badgeClass: 'bg-yellow-100 text-yellow-800' };
                case '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': return { icon: '‚ùå', badgeClass: 'bg-red-100 text-red-800' };
                case '‡∏•‡∏≤': return { icon: 'üìù', badgeClass: 'bg-blue-100 text-blue-800' };
                default: return { icon: '‚ùì', badgeClass: 'bg-gray-100 text-gray-800' };
            }
        };

        const stopAllIntervals = () => {
            if (dailyRecordsIntervalId) clearInterval(dailyRecordsIntervalId);
            if (liveMonitorIntervalId) clearInterval(liveMonitorIntervalId);
            dailyRecordsIntervalId = null;
            liveMonitorIntervalId = null;
            console.log("All intervals stopped.");
        };
        
        const showPage = (pageId) => {
            stopAllIntervals();
            const pages = ['loginPage', 'homePage', 'studentDetailPage', 'dailyRecordsPage', 'liveMonitorPage'];
            pages.forEach(p => {
                const pageElement = document.getElementById(p);
                if (p === pageId) {
                    pageElement.classList.remove('hidden');
                } else {
                    pageElement.classList.add('hidden');
                }
            });
            dom.mainContent.style.display = (pageId === 'liveMonitorPage') ? 'none' : 'block';
        };

        const handleLogin = (role, id) => {
            currentUserRole = role;
            currentUserId = id;
            sessionStorage.setItem('currentUserRole', role);
            sessionStorage.setItem('currentUserId', id);
            if (role === 'teacher') {
                showTeacherHomePage();
                Swal.fire('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π ‚úÖ', 'success');
            } else {
                 const student = students.find(s => s.id === id);
                 if(student) showStudentDetailPage(student);
                 else handleLogout();
            }
        };

        const handleLogout = () => {
            currentUserRole = null;
            currentUserId = null;
            sessionStorage.clear();
            
            // --- MODIFICATION: Clear the student ID input field ---
            dom.studentIdLoginInput.value = '';

            showPage('loginPage');
            Swal.fire('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö', '‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'info');
        };

        function showTeacherHomePage() {
            showPage('homePage');
            loadAttendanceData(updateAllHomePageComponents);
        }
        
        function showLiveMonitorPage() {
            showPage('liveMonitorPage');
            loadAttendanceData(() => {
                renderFullScreenMonitor(dom.summaryDateInput.value);
                liveMonitorIntervalId = setInterval(() => {
                    console.log("Auto-refreshing Live Monitor silently...");
                    loadAttendanceData(() => renderFullScreenMonitor(dom.summaryDateInput.value), false);
                }, 5000);
            });
        }
        
        function showStudentDetailPage(student) {
            stopAllIntervals();
            currentStudent = student;
            const studentDetailPage = dom.studentDetailPage;
            studentDetailPage.innerHTML = `
                <div class="flex justify-end items-center mb-6">
                     <button id="logoutButtonStudent" class="btn-primary flex items-center px-4 py-2 text-sm bg-gray-500 hover:bg-gray-600">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô üìù</h2>
                <div class="mb-6 bg-indigo-50 p-4 rounded-lg text-center">
                    <p class="text-2xl text-gray-700">
                        <span class="font-semibold">‡∏£‡∏´‡∏±‡∏™:</span> <span class="text-indigo-700 font-bold">${student.id}</span>
                    </p>
                    <p class="text-2xl text-gray-700 mt-2">
                        <span class="font-semibold">‡∏ä‡∏∑‡πà‡∏≠:</span> <span class="text-indigo-700 font-bold">${student.gender} ${student.firstName} ${student.lastName}</span>
                    </p>
                </div>
                <div class="mb-6 text-center">
                    <p class="text-lg text-gray-600 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="currentDateDisplay" class="font-semibold text-gray-800"></span></p>
                    <input type="date" id="attendanceDateInput" class="input-field max-w-xs mx-auto mb-4">
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <button class="btn-status status-present" data-status="‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                           <span>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
                        </button>
                         <button class="btn-status status-late" data-status="‡∏°‡∏≤‡∏™‡∏≤‡∏¢">
                             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" /></svg>
                            <span>‡∏°‡∏≤‡∏™‡∏≤‡∏¢</span>
                        </button>
                         <button class="btn-status status-absent" data-status="‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>
                           <span>‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
                        </button>
                         <button class="btn-status status-leave" data-status="‡∏•‡∏≤">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z" /></svg>
                            <span>‡∏•‡∏≤</span>
                        </button>
                    </div>
                </div>`;
            showPage('studentDetailPage');
            
            const attendanceDateInput = document.getElementById('attendanceDateInput');
            const currentDateDisplay = document.getElementById('currentDateDisplay');
            const today = formatDate(new Date());
            attendanceDateInput.value = today;
            currentDateDisplay.textContent = formatDisplayDate(new Date());

            document.getElementById('logoutButtonStudent').addEventListener('click', handleLogout);
            
            document.querySelectorAll('.btn-status').forEach(button => {
                button.addEventListener('click', (event) => {
                    const statusText = event.currentTarget.dataset.status;
                    if (!currentStudent) return;
                    saveAttendance(currentStudent.id, `${currentStudent.gender} ${currentStudent.firstName} ${currentStudent.lastName}`, document.getElementById('attendanceDateInput').value, statusText);
                });
            });
        }

        function showDailyRecordsPage() {
            showPage('dailyRecordsPage');
            const today = formatDate(new Date());
            dom.dailyRecordDateInput.value = today;
            loadAttendanceData(() => {
                displayDailyRecords(today);
                dailyRecordsIntervalId = setInterval(() => {
                    console.log("Auto-refreshing Daily Records silently...");
                    loadAttendanceData(() => displayDailyRecords(dom.dailyRecordDateInput.value), false);
                }, 5000);
            });
        }

        function renderFullScreenMonitor(selectedDate) {
            const recordsForDate = attendanceData.filter(r => r.date === selectedDate).sort((a,b) => new Date(b.timestamp) - new Date(a.timestamp));
            dom.fullScreenMonitorBody.innerHTML = '';
            if(recordsForDate.length === 0) {
                dom.fullScreenMonitorBody.innerHTML = `<div class="flex items-center justify-center h-full"><p class="text-gray-500 text-xl">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div>`;
                return;
            }
            const list = document.createElement('ul');
            list.className = 'divide-y divide-gray-100';
            recordsForDate.forEach(record => {
                const statusDetails = getStatusDetails(record.status);
                const listItem = document.createElement('li');
                listItem.className = 'p-4 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200';
                listItem.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-3xl mr-4">${statusDetails.icon}</span>
                        <div>
                            <p class="text-xl font-bold text-gray-800">${record.fullName}</p>
                            <p class="text-md text-gray-500">${new Date(record.timestamp).toLocaleTimeString('th-TH')}</p>
                        </div>
                    </div>
                    <span class="px-4 py-2 text-md font-bold rounded-full ${statusDetails.badgeClass}">${record.status}</span>
                `;
                list.appendChild(listItem);
            });
            dom.fullScreenMonitorBody.appendChild(list);
        }

        function updateAllHomePageComponents() {
            const selectedDate = dom.summaryDateInput.value;
            updateDailySummary(selectedDate);
            if (!dom.studentManagementSection.classList.contains('hidden')) {
                displayStudents(students, selectedDate);
            }
        }

        function displayStudents(studentArray, selectedDate) {
            dom.studentsTableBody.innerHTML = '';
            if (studentArray.length === 0) {
                dom.studentsTableBody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</td></tr>`;
                return;
            }
            studentArray.forEach(student => {
                const studentStatusToday = attendanceData.find(r => r.studentId === student.id && r.date === selectedDate);
                const statusText = studentStatusToday ? studentStatusToday.status : "‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                const { badgeClass } = getStatusDetails(statusText); 
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4">${student.id}</td>
                    <td class="px-6 py-4">${student.gender} ${student.firstName} ${student.lastName}</td>
                    <td class="px-6 py-4"><span class="px-2 py-1 text-xs font-semibold rounded-full ${badgeClass}">${statusText}</span></td>
                    <td class="px-6 py-4"><button data-student-id="${student.id}" class="select-student-btn text-indigo-600 hover:text-indigo-900 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button></td>
                `;
                dom.studentsTableBody.appendChild(row);
            });

            document.querySelectorAll('.select-student-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    if (currentUserRole !== 'teacher') return;
                    const student = students.find(s => s.id === event.target.dataset.studentId);
                    if (student) showStudentDetailPage(student);
                });
            });
        }

        function displayDailyRecords(date) {
            dom.dailyRecordsTableBody.innerHTML = '';
            const recordsForDate = attendanceData.filter(record => record.date === date).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            if (recordsForDate.length === 0) {
                dom.dailyRecordsTableBody.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
                return;
            }
            recordsForDate.forEach(record => {
                const { badgeClass } = getStatusDetails(record.status);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4">${formatDisplayDate(record.date)}</td>
                    <td class="px-6 py-4">${record.studentId}</td>
                    <td class="px-6 py-4">${record.fullName}</td>
                    <td class="px-6 py-4"><span class="px-2 py-1 text-xs font-semibold rounded-full ${badgeClass}">${record.status}</span></td>
                    <td class="px-6 py-4"><button data-student-id="${record.studentId}" data-full-name="${record.fullName}" data-record-date="${record.date}" data-current-status="${record.status}" class="edit-daily-record-btn text-blue-600 hover:text-blue-900 font-semibold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button></td>
                `;
                dom.dailyRecordsTableBody.appendChild(row);
            });
            
            document.querySelectorAll('.edit-daily-record-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const { studentId, fullName, recordDate, currentStatus } = event.target.dataset;
                    Swal.fire({
                        title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                        html: `<b>${fullName}</b><br>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${formatDisplayDate(recordDate)}`,
                        input: 'select',
                        inputOptions: { '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏°‡∏≤‡∏™‡∏≤‡∏¢': '‡∏°‡∏≤‡∏™‡∏≤‡∏¢', '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏•‡∏≤': '‡∏•‡∏≤' },
                        inputValue: currentStatus,
                        showCancelButton: true,
                        confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                        preConfirm: (newStatus) => {
                            if (!newStatus || newStatus === currentStatus) {
                                Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏¥‡∏°');
                                return false;
                            }
                            saveAttendance(studentId, fullName, recordDate, newStatus, true, currentStatus);
                        }
                    });
                });
            });
        }
        
        function updateDailySummary(selectedDate) {
            const summaryCounts = { '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': 0, '‡∏°‡∏≤‡∏™‡∏≤‡∏¢': 0, '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': 0, '‡∏•‡∏≤': 0, '‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•': 0, '‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î': students.length };
            students.forEach(student => {
                const record = attendanceData.find(r => r.studentId === student.id && r.date === selectedDate);
                summaryCounts[record ? record.status : '‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•']++;
            });
            dom.attendanceSummary.innerHTML = `
                <div class="card p-4 text-center"><p>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p><p class="text-2xl font-bold">${summaryCounts['‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î']}</p></div>
                <div class="card p-4 text-center"><p>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p><p class="text-2xl font-bold text-green-600">${summaryCounts['‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô']}</p></div>
                <div class="card p-4 text-center"><p>‡∏°‡∏≤‡∏™‡∏≤‡∏¢</p><p class="text-2xl font-bold text-yellow-600">${summaryCounts['‡∏°‡∏≤‡∏™‡∏≤‡∏¢']}</p></div>
                <div class="card p-4 text-center"><p>‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p><p class="text-2xl font-bold text-red-600">${summaryCounts['‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô']}</p></div>
                <div class="card p-4 text-center"><p>‡∏•‡∏≤</p><p class="text-2xl font-bold text-blue-600">${summaryCounts['‡∏•‡∏≤']}</p></div>`;
        }
        
        function loadAttendanceData(callback = () => {}, showLoadingIndicator = true) {
            if (showLoadingIndicator) Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', didOpen: () => Swal.showLoading(), timer: 15000, allowOutsideClick: false });
            const callbackName = 'gasResponseLoad_' + Date.now();
            window[callbackName] = function(response) {
                if (showLoadingIndicator) Swal.close();
                if (response && response.data) {
                    attendanceData = response.data.map(record => ({ ...record, date: formatDate(new Date(record.date)) }));
                    callback();
                } else if (showLoadingIndicator) {
                    Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
                }
                const scriptTag = document.getElementById('gasScript_' + callbackName);
                if (scriptTag) scriptTag.remove();
                delete window[callbackName];
            };
            const url = `${SCRIPT_URL}?action=get&callback=${callbackName}`;
            const script = document.createElement('script');
            script.src = url;
            script.id = 'gasScript_' + callbackName;
            document.body.appendChild(script);
        }
        
        function saveAttendance(studentId, fullName, date, status, isUpdate = false, originalStatus = '') {
            Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', didOpen: () => Swal.showLoading(), allowOutsideClick: false });
            const callbackName = 'gasResponseSave_' + Date.now();
            let queryParams = isUpdate ? new URLSearchParams({ action: 'update', studentId, fullName, date, newStatus: status, originalStatus }) : new URLSearchParams({ action: 'add', studentId, fullName, date, status });
            const url = `${SCRIPT_URL}?${queryParams.toString()}&callback=${callbackName}`;
            
            window[callbackName] = function(response) {
                const scriptTag = document.getElementById('gasScript_' + callbackName);
                if (scriptTag) scriptTag.remove();
                delete window[callbackName];

                if (response.result === 'success') {
                    if(currentUserRole === 'student'){
                        const successText = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! <br>
                            <div class='text-left mt-4'>
                                <strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</strong> ${fullName}<br>
                                <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${formatDisplayDate(date)}<br>
                                <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${status}
                            </div>`;
                        Swal.fire({
                            icon: 'success', title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', html: successText, confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
                        }).then(handleLogout);
                    } else {
                         Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', isUpdate ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' : '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success').then(() => {
                            if (currentStudent && !dom.studentDetailPage.classList.contains('hidden')) {
                                loadAttendanceData(() => showStudentDetailPage(currentStudent));
                            } else if (!dom.dailyRecordsPage.classList.contains('hidden')) {
                               loadAttendanceData(() => showDailyRecordsPage());
                            } else {
                                 loadAttendanceData(showTeacherHomePage);
                            }
                        });
                    }
                } else {
                    Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!', response.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
                }
            };
            const script = document.createElement('script');
            script.src = url;
            script.id = 'gasScript_' + callbackName;
            document.body.appendChild(script);
        }

        function renderAttendanceHistory(studentId) {
            const tableBody = document.getElementById('attendanceHistoryTableBody');
            if(!tableBody) return;
            tableBody.innerHTML = '';
            const studentRecords = attendanceData.filter(record => record.studentId === studentId).sort((a, b) => new Date(b.date) - new Date(a.date));

            if (studentRecords.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="3" class="px-6 py-4 text-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td></tr>`;
                return;
            }

            studentRecords.forEach(record => {
                const { badgeClass } = getStatusDetails(record.status);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${formatDisplayDate(record.date)}</td>
                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 py-1 text-xs font-semibold rounded-full ${badgeClass}">${record.status}</span></td>
                    <td class="px-6 py-4 whitespace-nowrap text-right"><button data-record-date="${record.date}" data-current-status="${record.status}" class="edit-record-btn text-blue-600 hover:text-blue-900 font-semibold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button></td>
                `;
                tableBody.appendChild(row);
            });

            document.querySelectorAll('.edit-record-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const { recordDate, currentStatus } = event.target.dataset;
                    Swal.fire({
                        title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                        input: 'select',
                        inputOptions: { '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏°‡∏≤‡∏™‡∏≤‡∏¢': '‡∏°‡∏≤‡∏™‡∏≤‡∏¢', '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏•‡∏≤': '‡∏•‡∏≤' },
                        inputValue: currentStatus,
                        showCancelButton: true,
                        confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                        preConfirm: (newStatus) => {
                            if (!newStatus || newStatus === currentStatus) {
                                Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏¥‡∏°');
                                return false;
                            }
                            saveAttendance(currentStudent.id, `${currentStudent.gender} ${currentStudent.firstName} ${currentStudent.lastName}`, recordDate, newStatus, true, currentStatus);
                        }
                    });
                });
            });
        }
        
        function updateAttendanceChart(studentId) {
            const chartCanvas = document.getElementById('attendanceChart');
            if (!chartCanvas) return;

            if (attendanceChartInstance) {
                attendanceChartInstance.destroy();
            }
            
            const studentRecords = attendanceData.filter(record => record.studentId === studentId);
            const statusCounts = { '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': 0, '‡∏°‡∏≤‡∏™‡∏≤‡∏¢': 0, '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô': 0, '‡∏•‡∏≤': 0 };
            studentRecords.forEach(record => {
                if (statusCounts.hasOwnProperty(record.status)) {
                    statusCounts[record.status]++;
                }
            });

            const data = {
                labels: ['‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏°‡∏≤‡∏™‡∏≤‡∏¢', '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏•‡∏≤'],
                datasets: [{
                    label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                    data: [statusCounts['‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'], statusCounts['‡∏°‡∏≤‡∏™‡∏≤‡∏¢'], statusCounts['‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'], statusCounts['‡∏•‡∏≤']],
                    backgroundColor: ['#34d399', '#fcd34d', '#ef4444', '#60a5fa'],
                    borderColor: ['#ffffff'],
                    borderWidth: 2
                }]
            };
            const config = {
                type: 'pie', data,
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { font: { family: 'Sarabun' } } },
                        title: { display: true, text: '‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', font: { size: 18, family: 'Sarabun' } }
                    }
                }
            };
            attendanceChartInstance = new Chart(chartCanvas.getContext('2d'), config);
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            // Check for existing session
            const storedUserRole = sessionStorage.getItem('currentUserRole');
            const storedUserId = sessionStorage.getItem('currentUserId');
            if (storedUserRole && storedUserId) {
                handleLogin(storedUserRole, storedUserId);
            } else {
                showPage('loginPage');
            }
            
            // --- NEW: Logic to show teacher login section on click ---
            const showTeacherLoginLink = document.getElementById('showTeacherLoginLink');
            const teacherLoginSection = document.getElementById('teacherLoginSection');
            const teacherLoginToggle = document.getElementById('teacherLoginToggle');

            showTeacherLoginLink.addEventListener('click', (event) => {
                event.preventDefault(); // Prevent link from navigating
                teacherLoginSection.classList.remove('hidden'); // Show the teacher login form
                teacherLoginToggle.classList.add('hidden');     // Hide the link itself
            });
        });

        dom.studentLoginButton.addEventListener('click', () => {
            const student = students.find(s => s.id === dom.studentIdLoginInput.value.trim());
            if (student) handleLogin('student', student.id);
            else Swal.fire('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤', 'error');
        });
        dom.studentIdLoginInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') dom.studentLoginButton.click();
        });


        dom.teacherLoginButton.addEventListener('click', () => {
            if(dom.teacherUsernameInput.value.trim() === 'teacher' && dom.teacherPasswordInput.value.trim() === 'password') {
                handleLogin('teacher', 'teacher');
            } else {
                Swal.fire('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
            }
        });
        
        dom.logoutButtonTeacher.addEventListener('click', handleLogout);
        dom.refreshDataButtonHome.addEventListener('click', () => loadAttendanceData(updateAllHomePageComponents));
        dom.openLiveMonitorButton.addEventListener('click', showLiveMonitorPage);
        dom.backToHomeFromMonitorButton.addEventListener('click', showTeacherHomePage);
        dom.viewDailyRecordsButton.addEventListener('click', showDailyRecordsPage);
        dom.backToHomeFromDailyRecordsButton.addEventListener('click', showTeacherHomePage);
        
        dom.toggleManagementButton.addEventListener('click', () => {
            dom.studentManagementSection.classList.toggle('hidden');
            const isHidden = dom.studentManagementSection.classList.contains('hidden');
            dom.toggleManagementButton.textContent = isHidden ? '‡πÅ‡∏™‡∏î‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤' : '‡∏ã‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤';
            if(!isHidden) displayStudents(students, dom.summaryDateInput.value);
        });

        dom.summaryDateInput.addEventListener('change', () => {
            loadAttendanceData(updateAllHomePageComponents);
        });
        
        dom.searchButton.addEventListener('click', () => {
            const query = dom.searchInput.value.toLowerCase();
            const filteredStudents = students.filter(s =>
                s.id.includes(query) || `${s.firstName} ${s.lastName}`.toLowerCase().includes(query)
            );
            displayStudents(filteredStudents, dom.summaryDateInput.value); 
        });

        dom.exportSpecificDailyRecordsButton.addEventListener('click', () => {
            const dateToExport = dom.dailyRecordDateInput.value;
            const recordsToExport = attendanceData.filter(record => record.date === dateToExport);

            if (recordsToExport.length === 0) {
                Swal.fire('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formatDisplayDate(dateToExport)} ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å`, 'info');
                return;
            }

            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            csvContent += "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤,‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\n";

            recordsToExport.forEach(record => {
                const row = [formatDisplayDate(record.date), record.studentId, `"${record.fullName}"`, record.status].join(",");
                csvContent += row + "\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô_${dateToExport}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

    </script>
</body>
</html>
